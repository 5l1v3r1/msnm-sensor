## MSNM sensor in action

If you are interested on to test the MSNM sensor, just follow the next steps.
In the figure you can see the scenario that we are going to build. Four are the involved routers (R1-3, BR (Border Router)). All of them, 
has a MSNMSensor instance and a configured netflow data source. The BR is 
in charge of gathering the information coming from the other on the lower hierarchy level (R1, R2 and R3). BR also computes
 new statistics (LbRtn, QbRtn) which are in turn obtained by joining all the data sources.

<img src="scenario_4/architecture.png" alt="Example functional architecture" width="60%">

- Activate the python 2.7 environment (see [How to install](../README.md))
- Go into **scripts/netflow/** folder
- Execute ipt-netflow collector engine and iptables integration.

    *NOTE: Before running the activation the following tools should be already installed.*

	    $ clone git://github.com/aabc/ipt-netflow.git
	    $ sudo apt-get install nfdump
	Run the script:
	
		$ sudo ./activateNetflow.sh

- Go into **examples/scenario_4/**
- Set the name of the sensors in *sensors.txt* (take a look at it)
- Configure the *\*.yaml* configuration files for every involved sensor. The filenames must to match with those found
in *sensors.txt* file. Additionally, *fcp\*.yaml* files, must be also configured if different 
data sources from *netflow* are used. Currently, they are configured by default allowing everything to work
(see documentation of the FCParser tool)
- Go into **scripts/** folder
- Run the experiment. The following command will also launch each sensor. Alternatively, you can also start each sensor one by one by running *./start.sh* script available at each sensor folder.

	   	$ ./start_experiment.sh ../examples/scenario_4

    NOTE: You can monitor how each sensor is working by inspecting config/scenario_4/<*sensorName*\>/logs/msnm.log

- Stop the experiment gracefully. This scripts stop all deployed sensors. Alternatively, you can also stop each sensor one by one by running *./stop.sh* script available at each sensor folder.

	   	$ ./stop_experiment.sh ../examples/scenario_4

- Copy the results obtained. This script backups the data generated by each sensor by copying it
to a *results* folder in *../examples/scenario_4*

	   	$ ./copy_results.sh ../examples/scenario_4

- Plotting the results. This scripts depicts the statistics evolution from the monitoring output of a specific sensor. Last two parameters are the upper control limits for each statistics.

	   	$./plot_statistics.py <path_to_data> <logscale> <ucld> <uclq> 
	   	$ Example: ./plot_statistics.py ../examples/scenario_4/results/20180102_162727/borderRouter/data/monitoring/output/ True 9.8 204.5
